<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VSTGUI: Create your own view for the WYSIWYG editor in VSTGUI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VSTGUI
   &#160;<span id="projectnumber">4.9</span>
   </div>
   <div id="projectbrief">Graphical User Interface Framework not only for VST plugins</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_page_create_your_own_ui_view.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Create your own view for the WYSIWYG editor in <a class="el" href="namespace_v_s_t_g_u_i.html">VSTGUI</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Introduction</h1>
<p>When you want to edit your own VST3 plugin. You can find the need to create your own View.</p>
<p>You can edit your plugin by doing "Right click &gt; Open UIDescription Editor"</p>
<div class="image">
<img src="editVST3.png" alt=""/>
<div class="caption">
Edit VST3 plugin</div></div>
   <p>You can find more information about this interface in the documentation : "VSTGUI 4 &gt; VSTGUI &gt; New Inline UI Editor for VST3 (WYSIWYG) &gt; The Editor".</p>
<p>During this tutorial we will make a new view that will appear in the "Views Tab" at the bottom right of the editor and it allow us to drag and drop it inside our VST3 plugin.</p>
<h1>Create the new view class</h1>
<p>To create a new graphical view you need to create a class that inherites from <em>CView</em> or <em>CControl</em>. We recommend that you start with the <em>CControl</em> class when you plan to have an interactive view, otherwise if it only should display data use <em>CView</em>.</p>
<p>Your header file should look like this :</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#pragma once</div>
<div class="line"> </div>
<div class="line">#include &quot;vstgui/vstgui.h&quot;</div>
<div class="line"> </div>
<div class="line">namespace VSTGUI {</div>
<div class="line"> </div>
<div class="line">class MyControl : public CControl</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line">    MyControl (const CRect&amp; size );</div>
<div class="line">    </div>
<div class="line">    void draw (CDrawContext *pContext) override;</div>
<div class="line"> </div>
<div class="line">    CLASS_METHODS (MyControl, CControl)</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} // namespace VSTGUI</div>
</div><!-- fragment --><p>And your cpp file :</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#include &quot;MyControl.h&quot;</div>
<div class="line"> </div>
<div class="line">namespace VSTGUI {</div>
<div class="line"> </div>
<div class="line">MyControl::MyControl (const CRect&amp; size) : CControl (size) {}</div>
<div class="line"> </div>
<div class="line">void MyControl::draw (CDrawContext* pContext)</div>
<div class="line">{</div>
<div class="line">    // --- setup the background rectangle</div>
<div class="line">    pContext-&gt;setLineWidth (1);</div>
<div class="line">    pContext-&gt;setFillColor (CColor (255, 255, 255, 255)); // white background </div>
<div class="line">    pContext-&gt;setFrameColor (CColor (0, 0, 0, 255)); // black borders</div>
<div class="line"> </div>
<div class="line">    // --- draw the rect filled (with white) and stroked (line around rectangle)</div>
<div class="line">    pContext-&gt;drawRect (getViewSize (), kDrawFilledAndStroked);</div>
<div class="line"> </div>
<div class="line">    setDirty (false);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} // namespace VSTGUI</div>
</div><!-- fragment --><p>We have two functions, the constructor which only calls the parent constructor and the <em>draw</em> function which will define the design of the view. In this example we draw a white rectangle with black borders.</p>
<h1>Register your view</h1>
<p>So now you have a basic graphical view. But it will not appear in the list when you edit your plugin.</p>
<p>You need to create a new class, a "factory", that will register your view and create it. This class only needs a cpp file (if you strip dead code in your linker settings, then you need to make sure that this class is not stripped).</p>
<p>Let us begin by creating an empty class that inherites from *'ViewCreatorAdapter'* :</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#pragma once</div>
<div class="line"> </div>
<div class="line">#include &quot;vstgui/vstgui.h&quot;</div>
<div class="line">#include &quot;vstgui/vstgui_uidescription.h&quot;</div>
<div class="line">#include &quot;vstgui/uidescription/detail/uiviewcreatorattributes.h&quot;</div>
<div class="line"> </div>
<div class="line">// Replace this include by the header file of your new view.</div>
<div class="line">#include &quot;MyControl.h&quot; </div>
<div class="line"> </div>
<div class="line">namespace VSTGUI {</div>
<div class="line"> </div>
<div class="line">class MyControlFactory : public ViewCreatorAdapter</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} // namespace VSTGUI</div>
</div><!-- fragment --><p>In the constructor we need to register our view to the UIViewFactory. If we don't do that it will not appear in the list that will allow us to add the view to our VST3 plugin.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">MyControlFactory () { UIViewFactory::registerViewCreator (*this); }</div>
</div><!-- fragment --><p>The main factory needs 3 others functions :</p>
<ul>
<li>The name of the view (as shown in the WYSIWYS editor)</li>
</ul>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">IdStringPtr getViewName () const { return &quot;Name of my UI component&quot;; }</div>
</div><!-- fragment --><ul>
<li>The parent class of the view (In this tutorial we're using <em>CControl</em>)</li>
</ul>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">IdStringPtr getBaseViewName () const { return UIViewCreator::kCControl; }</div>
</div><!-- fragment --><ul>
<li>and a creator method which returns a new view with a default size</li>
</ul>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">CView* create (const UIAttributes&amp; attributes, const IUIDescription* description) const</div>
<div class="line">{</div>
<div class="line">    return new MyControl (CRect (0, 0, 100, 100));</div>
<div class="line">}</div>
</div><!-- fragment --><p>You also need to create a static variable having the same type as our factory. This variable will call the constructor of your factory. Thus, your view will be registered automatically.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">MyControlFactory __gMyControlFactory;</div>
</div><!-- fragment --><p>So at the end you should have something like this :</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">#pragma once</div>
<div class="line">#include &quot;vstgui/vstgui.h&quot;</div>
<div class="line">#include &quot;vstgui/vstgui_uidescription.h&quot;</div>
<div class="line">#include &quot;vstgui/uidescription/detail/uiviewcreatorattributes.h&quot;</div>
<div class="line">#include &quot;MyControl.h&quot;</div>
<div class="line"> </div>
<div class="line">namespace VSTGUI {</div>
<div class="line"> </div>
<div class="line">class MyControlFactory : public ViewCreatorAdapter</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line">    // register this class with the view factory</div>
<div class="line">    MyControlFactory () { UIViewFactory::registerViewCreator (*this); }</div>
<div class="line"> </div>
<div class="line">    // return an unique name here</div>
<div class="line">    IdStringPtr getViewName () const override { return &quot;Name of my UI component&quot;; }</div>
<div class="line"> </div>
<div class="line">    // return the name here from where your custom view inherites.</div>
<div class="line">    // Your view automatically supports the attributes from it.</div>
<div class="line">    IdStringPtr getBaseViewName () const override { return UIViewCreator::kCControl; }</div>
<div class="line"> </div>
<div class="line">    // create your view here.</div>
<div class="line">    // Note you don&#39;t need to apply attributes here as</div>
<div class="line">    // the apply method will be called with this new view</div>
<div class="line">    CView* create (const UIAttributes&amp; attributes, const IUIDescription* description) const override</div>
<div class="line">    {</div>
<div class="line">        CRect size (CPoint (45, 45), CPoint (400, 150) );</div>
<div class="line">        return new MyControl (size);</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line">// create a static instance so that it registers itself with the view factory</div>
<div class="line">MyControlFactory __gMyControlFactory;</div>
<div class="line"> </div>
<div class="line">} // namespace VSTGUI</div>
</div><!-- fragment --><h1>Result</h1>
<p>Now if you come back to the VST 3 plugin Editor you can find your new view in the list.</p>
<div class="image">
<img src="newuicompname.png" alt=""/>
<div class="caption">
Edit VST3 plugin</div></div>
    </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Nov 16 2020 08:55:12 for VSTGUI by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
